[**《ARM Cortex-M0 权威指南》笔记（7）—中断控制和系统控制**](http://www.yyearth.com/article/21-08/294.html)

 

来自 <https://www.yyearth.com/article/21-08/294.html> 

 

**中断控制寄存器**

中断控制寄存器，用于控制中断请求（异常编号为16及以上）的使能和禁止。寄存器的宽度根据支持的中断数量而不同，最大为32位，最小为1位。

 

 **中断挂起状态寄存器**

如果一个中断发生了，却无法立即处理，这个中断请求将被挂起。挂起状态保存在一个寄存器中，如果处理器的当前优先级还没有降低到可以处理挂起的请求，并且没有手动清除挂起状态，该状态将一直保持合法。

通过操作中断设置挂起（SETPEND）和中断清除挂起（CLRPEND）两个寄存器来访问或修改中断挂起状态。类似中断使能控制寄存器，中断挂起状态寄存器也是物理上为一个寄存器，而通过两个地址来实现设置和清除相关位

 

**中断优先级**

每个外部中断都有一个对应的优先级寄存器，每个优先级都是2位宽，并且使用中断优先级寄存器的最高两位，每个寄存器占1个字节（8位）。Cortex-M0中的NVIC寄存器只支持字传输，这样每次访问都会同时涉及4个中断优先级寄存器。

 

（1）Cortex-M0中NVIC-IPR共有8个寄存器，而每个寄存器管理4个IRQ中断，所以M0+的IRQ中断源最多只支持32个了，再加上16个内核中断，也就是说M0+最多就是48个中断源；

 

（2）优先级寄存器里面的配置值越低表明相应的中断优先级越高；

 

（3）每个PRIxx的8位中只有最高两位[7:6]有效，也就是说实际上M0+的优先级只有四个即0，1，2，3，其中0的优先级是最高的；

 

（4）这是比较容易忽略的问题，即word-accessible，也就是说这几个寄存器都只能按字操作，切记不要使用指向字节的指针只对某个单独中断的优先级进行配置。

 

（5）M0的嵌套相对比较简单，即只要相应中断的优先级比较高即可随时抢占比它优先级低的中断服务。

 

（6）内核中断，其中断优先级则由SCB模块的SCB_SHPR寄存器来管理，可参考手册4.3.7 System Handler Priority Registers，实际上我们平时常用的就是systemtick中断，其优先级配置同NVIC。