- 1. 中断触发

- - 当外部中断事件发生时，MCU会检测到中断信号，并立即停止当前正在执行的任务（或代码）
  - 保存上下文

- - MCU会自动保存当前任务的上下文（包括程序计数器、寄存器状态等），以便在中断处理完成后能够恢复任务继续执行。
  - 跳转到中断服务程序（ISR）

- - MCU会根据中断向量表跳转到对应的中断服务程序（ISR）。ISR是预先定义好的处理中断事件的函数。
  - 执行中断服务程序（ISR）

- - 在ISR中，开发者可以编写处理中断事件的代码。例如，读取外部设备的状态、设置标志位、发送信号量等。
  - 在FreeRTOS中，ISR通常分为两部分：
  - ISR入口部分：处理硬件相关的操作，如清除中断标志、读取数据等。
  - ISR出口部分：处理与任务相关的操作，如发送信号量、任务通知等。

-  5.任务切换（可选）

- - 如果ISR中发送了信号量、任务通知等，可能会导致任务切换。FreeRTOS会在ISR退出时检查是否有更高优先级的任务就绪，如果有，则会进行任务切换。
  - 任务切换时，FreeRTOS会保存当前任务的上下文，并加载新任务的上下文。

- 6.恢复上下文

- - 如果ISR没有导致任务切换，MCU会恢复之前保存的上下文，继续执行被中断的任务。
  - 如果发生了任务切换，MCU会加载新任务的上下文，并开始执行新任务。
  - 继续执行

- - 被中断的任务或新任务继续执行，MCU恢复正常运行状态。

-  

-  

- 关键点：

- - 上下文保存与恢复：MCU会自动保存和恢复任务的上下文，确保中断处理完成后任务能够继续执行。
  - 任务切换：ISR中的操作（如发送信号量）可能会导致任务切换，FreeRTOS会在ISR退出时检查并执行任务切换。
  - 中断优先级：FreeRTOS支持中断优先级管理，高优先级中断可以打断低优先级中断。